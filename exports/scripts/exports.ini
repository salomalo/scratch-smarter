[db]
username = root
password = 
hostname = 127.0.0.1 
database = factoryshoe
port = 3306

[setting]
display = true
timeout = 300
insertlimit = 1
alertdays = 3
path = ""

[logging]
logfile = log.txt
logstatus = status.txt

[nullcheck]
skudata.txt=0
extract_tblOneOfShoes.txt=0
vendors.txt=0
styles.txt=0
mthwksls.txt=1
onorder.txt=1
receipts.txt=1
instock.txt=1

[files]
filename[] = "skudata.txt"
delimiter[] = ","
tablename[] = "fs_skus"
columns[] =	"(sku, size, price)"
duplicate[] = "ON DUPLICATE KEY UPDATE sku=VALUES(sku), size=VALUES(size), price=VALUES(price);"

filename[] = "extract_tblOneOfShoes.txt"
delimiter[] = ","
tablename[] = "fs_mismates"
columns[] =	"(sku, found_dt,size, price, foot, store, id, status,create_time)"
duplicate[] = "ON DUPLICATE KEY UPDATE sku=VALUES(sku), size=VALUES(size), price=VALUES(price),foot=VALUES(foot),store=VALUES(store),id=VALUES(id),create_time=VALUES(create_time);"

filename[] = "vendors.txt"
delimiter[] = ";"
tablename[] = "fs_vendors"
columns[] =	"(vendor_id, `name`, address1, address2, city, province,country, postal_code, phone, fax, contact,pur_py,pur_ly,pur_cy)"
duplicate[] = "ON DUPLICATE KEY UPDATE fax=VALUES(fax);"

filename[] = "styles.txt"
delimiter[] = ";"
tablename[] = "fs_styles"
columns[] =	"(style_id, vendor_id, price,fillin,compare_at,retail,red_tag,dept, class, model, width,colour,vendor_colour)"
duplicate[] = "ON DUPLICATE KEY UPDATE vendor_id=VALUES(vendor_id), price=VALUES(price), fillin=VALUES(fillin), compare_at=VALUES(compare_at), retail=VALUES(retail), red_tag=VALUES(red_tag), dept=VALUES(dept), class=VALUES(class), model=VALUES(model), width=VALUES(width), colour=VALUES(colour), vendor_colour=VALUES(vendor_colour);"

filename[] = "mthwksls.txt"
delimiter[] = ";"
tablename[] = "fs_sales"
columns[] =	"(style_id, period,`1`,`1_5`,`2`,`2_5`,`3`,`3_5`,`4`,`4_5`,`5`,`5_5`,`6`,`6_5`,`7`,`7_5`,`8`,`8_5`,`9`,`9_5`,`10`,`10_5`,`11`,`11_5`,`12`,`12_5`,`13`,`13_5`,`14`,`15`,`16`)"
duplicate[] = ";"

filename[] = "onorder.txt"
delimiter[] = ";"
tablename[] = "fs_on_order"
columns[] =	"(style_id,po,dlvry_dt,`1`,`1_5`,`2`,`2_5`,`3`,`3_5`,`4`,`4_5`,`5`,`5_5`,`6`,`6_5`,`7`,`7_5`,`8`,`8_5`,`9`,`9_5`,`10`,`10_5`,`11`,`11_5`,`12`,`12_5`,`13`,`13_5`,`14`,`15`,`16`,`17`,`18`)"
duplicate[] = ";"

filename[] = "receipts.txt"
delimiter[] = ";"
tablename[] = "fs_receipt"
columns[] =	"(style_id,rec_dt,`1`,`1_5`,`2`,`2_5`,`3`,`3_5`,`4`,`4_5`,`5`,`5_5`,`6`,`6_5`,`7`,`7_5`,`8`,`8_5`,`9`,`9_5`,`10`,`10_5`,`11`,`11_5`,`12`,`12_5`,`13`,`13_5`,`14`,`15`,`16`)"
duplicate[] = ";"

filename[] = "instock.txt"
delimiter[] = ";"
tablename[] = "fs_instock_temp"
columns[] =	"(style_id,`size`,`qty`)"
duplicate[] = ";"

[pre]
query[] = "TRUNCATE fs_sales;"
query[] = "DELETE FROM lov WHERE TYPE IN ('class','dept','model');"
query[] = "TRUNCATE fs_on_order;"
query[] = "TRUNCATE fs_receipt;"
query[] = "TRUNCATE fs_instock;"
query[] = "TRUNCATE fs_instock_temp;"
query[] = "TRUNCATE notification;"

[post]
query[] ="insert into fs_skus (sku, SIZE, PRICE) select distinct m.sku, m.size, m.price from fs_mismates as m
left join fs_skus as s on m.sku = s.SKU where s.SKU is null;"

query[] = "UPDATE fs_sales
SET period_dt= CONCAT('20',LEFT(period,2),'-',SUBSTR(period,3,2),'-',IF(RIGHT(period,2)='00','01',RIGHT(period,2))) ;"

query[] = "INSERT INTO fs_sales (style_id, period, period_dt, owner_id, group_id, group_perm, other_perm, update_by, update_time, create_by, create_time,`1`,`1_5`,`2`,`2_5`,`3`,`3_5`,`4`,`4_5`,`5`,`5_5`,`6`,`6_5`,`7`,`7_5`,`8`,`8_5`,`9`,`9_5`,`10`,`10_5`,`11`,`11_5`,`12`,`12_5`,`13`,`13_5`,`14`,`15`,`16`,`17`,`18`)
SELECT style_id, 'Total' AS period, '2001-01-01' AS period_dt, 0, 1, 1, 1, 1, NOW(), 1, NOW(), 
IF(SUM(`1`)=0,'',SUM(`1`)) AS `1`, IF(SUM(`1_5`)=0,'',SUM(`1_5`)) AS `1_5`, IF(SUM(`2`)=0,'',SUM(`2`)) AS `2`, IF(SUM(`2_5`)=0,'',SUM(`2_5`)) AS `2_5`, IF(SUM(`3`)=0,'',SUM(`3`)) AS `3`, IF(SUM(`3_5`)=0,'',SUM(`3_5`)) AS `3_5`, IF(SUM(`4`)=0,'',SUM(`4`)) AS `4`, IF(SUM(`4_5`)=0,'',SUM(`4_5`)) AS `4_5`, IF(SUM(`5`)=0,'',SUM(`5`)) AS `5`, IF(SUM(`5_5`)=0,'',SUM(`5_5`)) AS `5_5`, IF(SUM(`6`)=0,'',SUM(`6`)) AS `6`, IF(SUM(`6_5`)=0,'',SUM(`6_5`)) AS `6_5`, IF(SUM(`7`)=0,'',SUM(`7`)) AS `7`, IF(SUM(`7_5`)=0,'',SUM(`7_5`)) AS `7_5`, IF(SUM(`8`)=0,'',SUM(`8`)) AS `8`, IF(SUM(`8_5`)=0,'',SUM(`8_5`)) AS `8_5`, IF(SUM(`9`)=0,'',SUM(`9`)) AS `9`, IF(SUM(`9_5`)=0,'',SUM(`9_5`)) AS `9_5`, IF(SUM(`10`)=0,'',SUM(`10`)) AS `10`, IF(SUM(`10_5`)=0,'',SUM(`10_5`)) AS `10_5`, IF(SUM(`11`)=0,'',SUM(`11`)) AS `11`, IF(SUM(`11_5`)=0,'',SUM(`11_5`)) AS `11_5`, IF(SUM(`12`)=0,'',SUM(`12`)) AS `12`, IF(SUM(`12_5`)=0,'',SUM(`12_5`)) AS `12_5`, IF(SUM(`13`)=0,'',SUM(`13`)) AS `13`, IF(SUM(`13_5`)=0,'',SUM(`13_5`)) AS `13_5`, IF(SUM(`14`)=0,'',SUM(`14`)) AS `14`, IF(SUM(`15`)=0,'',SUM(`15`)) AS `15`, IF(SUM(`16`)=0,'',SUM(`16`)) AS `16`, IF(SUM(`17`)=0,'',SUM(`17`)) AS `17`, IF(SUM(`18`)=0,'',SUM(`18`)) AS `18`
 FROM fs_sales
 GROUP BY style_id;"

query[] = "UPDATE fs_sales b,
(SELECT style_id,period, sum( ifnull(`1`,0) + ifnull(`1_5`,0) + ifnull(`2`,0) + ifnull(`2_5`,0) + ifnull(`3`,0) + ifnull(`3_5`,0) + ifnull(`4`,0) 
+ ifnull(`4_5`,0) + ifnull(`5`,0) + ifnull(`5_5`,0) + ifnull(`6`,0) + ifnull(`6_5`,0) + ifnull(`7`,0) + ifnull(`7_5`,0) + ifnull(`8`,0) 
+ ifnull(`8_5`,0) + ifnull(`9`,0) + ifnull(`9_5`,0) + ifnull(`10`,0) + ifnull(`10_5`,0) + ifnull(`11`,0) + ifnull(`11_5`,0) + ifnull(`12`,0) 
+ ifnull(`12_5`,0) + ifnull(`13`,0) + ifnull(`13_5`,0) + ifnull(`14`,0) + ifnull(`15`,0) + ifnull(`16`,0) + ifnull(`17`,0) + ifnull(`18`,0)
)AS qty
 FROM fs_sales
 GROUP BY style_id,period) AS a
SET b.total= a.qty
WHERE b.style_id=a.style_id
AND b.period = a.period;"

query[] = "DELETE FROM fs_on_order WHERE style_id='';"
query[] = "UPDATE fs_on_order SET delivery_dt= CONCAT('20',RIGHT(dlvry_dt,2),'-',SUBSTR(dlvry_dt,4,2),'-',LEFT(dlvry_dt,2)) ;"
query[] = "DELETE FROM fs_receipt WHERE style_id='';"
query[] = "UPDATE fs_receipt SET receipt_dt= CONCAT('20',RIGHT(rec_dt,2),'-',SUBSTR(rec_dt,4,2),'-',LEFT(rec_dt,2)) ;"

query[] = "INSERT INTO fs_instock (style_id,`1`)
SELECT style_id, qty FROM fs_instock_temp WHERE size='1' AND qty <> ' '
ON DUPLICATE KEY UPDATE `1` = fs_instock_temp.qty;"

query[] = "INSERT INTO fs_instock (style_id,`1_5`)
SELECT style_id, qty FROM fs_instock_temp WHERE size='1-' AND qty <> ' '
ON DUPLICATE KEY UPDATE `1_5` = fs_instock_temp.qty;"

query[] = "INSERT INTO fs_instock (style_id,`2`)
SELECT style_id, qty FROM fs_instock_temp WHERE size='2' AND qty <> ' '
ON DUPLICATE KEY UPDATE `2` = fs_instock_temp.qty;"

query[] = "INSERT INTO fs_instock (style_id,`2_5`)
SELECT style_id, qty FROM fs_instock_temp WHERE size='2-' AND qty <> ' '
ON DUPLICATE KEY UPDATE `2_5` = fs_instock_temp.qty;"

query[] = "INSERT INTO fs_instock (style_id,`3`)
SELECT style_id, qty FROM fs_instock_temp WHERE size='3' AND qty <> ' '
ON DUPLICATE KEY UPDATE `3` = fs_instock_temp.qty;"

query[] = "INSERT INTO fs_instock (style_id,`3_5`)
SELECT style_id, qty FROM fs_instock_temp WHERE size='3-' AND qty <> ' '
ON DUPLICATE KEY UPDATE `3_5` = fs_instock_temp.qty;"

query[] = "INSERT INTO fs_instock (style_id,`4`)
SELECT style_id, qty FROM fs_instock_temp WHERE size='4' AND qty <> ' '
ON DUPLICATE KEY UPDATE `4` = fs_instock_temp.qty;"

query[] = "INSERT INTO fs_instock (style_id,`4_5`)
SELECT style_id, qty FROM fs_instock_temp WHERE size='4-' AND qty <> ' '
ON DUPLICATE KEY UPDATE `4_5` = fs_instock_temp.qty;"

query[] = "INSERT INTO fs_instock (style_id,`5`)
SELECT style_id, qty FROM fs_instock_temp WHERE size='5' AND qty <> ' '
ON DUPLICATE KEY UPDATE `5` = fs_instock_temp.qty;"

query[] = "INSERT INTO fs_instock (style_id,`5_5`)
SELECT style_id, qty FROM fs_instock_temp WHERE size='5-' AND qty <> ' '
ON DUPLICATE KEY UPDATE `5_5` = fs_instock_temp.qty;"

query[] = "INSERT INTO fs_instock (style_id,`6`)
SELECT style_id, qty FROM fs_instock_temp WHERE size='6' AND qty <> ' '
ON DUPLICATE KEY UPDATE `6` = fs_instock_temp.qty;"

query[] = "INSERT INTO fs_instock (style_id,`6_5`)
SELECT style_id, qty FROM fs_instock_temp WHERE size='6-' AND qty <> ' '
ON DUPLICATE KEY UPDATE `6_5` = fs_instock_temp.qty;"

query[] = "INSERT INTO fs_instock (style_id,`7`)
SELECT style_id, qty FROM fs_instock_temp WHERE size='7' AND qty <> ' '
ON DUPLICATE KEY UPDATE `7` = fs_instock_temp.qty;"

query[] = "INSERT INTO fs_instock (style_id,`7_5`)
SELECT style_id, qty FROM fs_instock_temp WHERE size='7-' AND qty <> ' '
ON DUPLICATE KEY UPDATE `7_5` = fs_instock_temp.qty;"

query[] = "INSERT INTO fs_instock (style_id,`8`)
SELECT style_id, qty FROM fs_instock_temp WHERE size='8' AND qty <> ' '
ON DUPLICATE KEY UPDATE `8` = fs_instock_temp.qty;"

query[] = "INSERT INTO fs_instock (style_id,`8_5`)
SELECT style_id, qty FROM fs_instock_temp WHERE size='8-' AND qty <> ' '
ON DUPLICATE KEY UPDATE `8_5` = fs_instock_temp.qty;"

query[] = "INSERT INTO fs_instock (style_id,`9`)
SELECT style_id, qty FROM fs_instock_temp WHERE size='9' AND qty <> ' '
ON DUPLICATE KEY UPDATE `9` = fs_instock_temp.qty;"

query[] = "INSERT INTO fs_instock (style_id,`9_5`)
SELECT style_id, qty FROM fs_instock_temp WHERE size='9-' AND qty <> ' '
ON DUPLICATE KEY UPDATE `9_5` = fs_instock_temp.qty;"

query[] = "INSERT INTO fs_instock (style_id,`10`)
SELECT style_id, qty FROM fs_instock_temp WHERE size='10' AND qty <> ' '
ON DUPLICATE KEY UPDATE `10` = fs_instock_temp.qty;"

query[] = "INSERT INTO fs_instock (style_id,`10_5`)
SELECT style_id, qty FROM fs_instock_temp WHERE size='10-' AND qty <> ' '
ON DUPLICATE KEY UPDATE `10_5` = fs_instock_temp.qty;"

query[] = "INSERT INTO fs_instock (style_id,`11`)
SELECT style_id, qty FROM fs_instock_temp WHERE size='11' AND qty <> ' '
ON DUPLICATE KEY UPDATE `11` = fs_instock_temp.qty;"

query[] = "INSERT INTO fs_instock (style_id,`11_5`)
SELECT style_id, qty FROM fs_instock_temp WHERE size='11-' AND qty <> ' '
ON DUPLICATE KEY UPDATE `11_5` = fs_instock_temp.qty;"

query[] = "INSERT INTO fs_instock (style_id,`12`)
SELECT style_id, qty FROM fs_instock_temp WHERE size='12' AND qty <> ' '
ON DUPLICATE KEY UPDATE `12` = fs_instock_temp.qty;"

query[] = "INSERT INTO fs_instock (style_id,`12_5`)
SELECT style_id, qty FROM fs_instock_temp WHERE size='12-' AND qty <> ' '
ON DUPLICATE KEY UPDATE `12_5` = fs_instock_temp.qty;"

query[] = "INSERT INTO fs_instock (style_id,`13`)
SELECT style_id, qty FROM fs_instock_temp WHERE size='13' AND qty <> ' '
ON DUPLICATE KEY UPDATE `13` = fs_instock_temp.qty;"

query[] = "INSERT INTO fs_instock (style_id,`13_5`)
SELECT style_id, qty FROM fs_instock_temp WHERE size='13-' AND qty <> ' '
ON DUPLICATE KEY UPDATE `13_5` = fs_instock_temp.qty;"

query[] = "INSERT INTO fs_instock (style_id,`14`)
SELECT style_id, qty FROM fs_instock_temp WHERE size='14' AND qty <> ' '
ON DUPLICATE KEY UPDATE `14` = fs_instock_temp.qty;"

query[] = "INSERT INTO fs_instock (style_id,`15`)
SELECT style_id, qty FROM fs_instock_temp WHERE size='15' AND qty <> ' '
ON DUPLICATE KEY UPDATE `15` = fs_instock_temp.qty;"

query[] = "INSERT INTO fs_instock (style_id,`16`)
SELECT style_id, qty FROM fs_instock_temp WHERE size='16' AND qty <> ' '
ON DUPLICATE KEY UPDATE `16` = fs_instock_temp.qty;"

query[] = "INSERT INTO fs_instock (style_id,`17`)
SELECT style_id, qty FROM fs_instock_temp WHERE size='17' AND qty <> ' '
ON DUPLICATE KEY UPDATE `17` = fs_instock_temp.qty;"

query[] = "INSERT INTO fs_instock (style_id,`18`)
SELECT style_id, qty FROM fs_instock_temp WHERE size='18' AND qty <> ' '
ON DUPLICATE KEY UPDATE `18` = fs_instock_temp.qty;"

query[] = "INSERT INTO fs_vendors (vendor_id, `name`) 
SELECT DISTINCT s.vendor_id, s.vendor_id
FROM fs_styles AS s
LEFT JOIN fs_vendors AS v
ON v.vendor_id = s.vendor_id
WHERE v.vendor_id IS NULL;"

query[] = "UPDATE fs_instock b,
(SELECT style_id, sum( ifnull(`1`,0) + ifnull(`1_5`,0) + ifnull(`2`,0) + ifnull(`2_5`,0) + ifnull(`3`,0) + ifnull(`3_5`,0) + ifnull(`4`,0) 
+ ifnull(`4_5`,0) + ifnull(`5`,0) + ifnull(`5_5`,0) + ifnull(`6`,0) + ifnull(`6_5`,0) + ifnull(`7`,0) + ifnull(`7_5`,0) + ifnull(`8`,0) 
+ ifnull(`8_5`,0) + ifnull(`9`,0) + ifnull(`9_5`,0) + ifnull(`10`,0) + ifnull(`10_5`,0) + ifnull(`11`,0) + ifnull(`11_5`,0) + ifnull(`12`,0) 
+ ifnull(`12_5`,0) + ifnull(`13`,0) + ifnull(`13_5`,0) + ifnull(`14`,0) + ifnull(`15`,0) + ifnull(`16`,0) + ifnull(`17`,0) + ifnull(`18`,0)
)AS qty
 FROM fs_instock
 GROUP BY style_id) AS a
SET b.total= a.qty
WHERE b.style_id=a.style_id;"

query[] = "UPDATE fs_on_order b,
(SELECT style_id,delivery_dt, sum( ifnull(`1`,0) + ifnull(`1_5`,0) + ifnull(`2`,0) + ifnull(`2_5`,0) + ifnull(`3`,0) + ifnull(`3_5`,0) + ifnull(`4`,0) 
+ ifnull(`4_5`,0) + ifnull(`5`,0) + ifnull(`5_5`,0) + ifnull(`6`,0) + ifnull(`6_5`,0) + ifnull(`7`,0) + ifnull(`7_5`,0) + ifnull(`8`,0) 
+ ifnull(`8_5`,0) + ifnull(`9`,0) + ifnull(`9_5`,0) + ifnull(`10`,0) + ifnull(`10_5`,0) + ifnull(`11`,0) + ifnull(`11_5`,0) + ifnull(`12`,0) 
+ ifnull(`12_5`,0) + ifnull(`13`,0) + ifnull(`13_5`,0) + ifnull(`14`,0) + ifnull(`15`,0) + ifnull(`16`,0) + ifnull(`17`,0) + ifnull(`18`,0)
)AS qty
 FROM fs_on_order
 GROUP BY style_id,delivery_dt) AS a
SET b.total= a.qty
WHERE b.style_id=a.style_id
AND b.delivery_dt = a.delivery_dt;"

query[] = "UPDATE fs_receipt b,
(SELECT style_id,receipt_dt, sum( ifnull(`1`,0) + ifnull(`1_5`,0) + ifnull(`2`,0) + ifnull(`2_5`,0) + ifnull(`3`,0) + ifnull(`3_5`,0) + ifnull(`4`,0) 
+ ifnull(`4_5`,0) + ifnull(`5`,0) + ifnull(`5_5`,0) + ifnull(`6`,0) + ifnull(`6_5`,0) + ifnull(`7`,0) + ifnull(`7_5`,0) + ifnull(`8`,0) 
+ ifnull(`8_5`,0) + ifnull(`9`,0) + ifnull(`9_5`,0) + ifnull(`10`,0) + ifnull(`10_5`,0) + ifnull(`11`,0) + ifnull(`11_5`,0) + ifnull(`12`,0) 
+ ifnull(`12_5`,0) + ifnull(`13`,0) + ifnull(`13_5`,0) + ifnull(`14`,0) + ifnull(`15`,0) + ifnull(`16`,0) + ifnull(`17`,0) + ifnull(`18`,0)
)AS qty
 FROM fs_receipt
 GROUP BY style_id,receipt_dt) AS a
SET b.total= a.qty
WHERE b.style_id=a.style_id
AND b.receipt_dt = a.receipt_dt;"


query[] = "UPDATE fs_styles SET onorder = NULL, instock=NULL;"
query[] = "UPDATE fs_styles AS s, (SELECT DISTINCT style_id FROM fs_on_order) AS o SET onorder = 1 WHERE s.style_id = o.style_id;"
query[] = "UPDATE fs_styles AS s, (SELECT DISTINCT style_id FROM fs_instock) AS o SET instock = 1 WHERE s.style_id = o.style_id;"
query[] = "UPDATE fs_vendors SET STATUS=NULL;"
query[] = "UPDATE fs_vendors AS s, (SELECT DISTINCT vendor_id FROM fs_styles WHERE instock =1 OR onorder=1) AS o SET STATUS = 1 WHERE s.vendor_id = o.vendor_id;"

query[] = "INSERT INTO notification (TYPE,SUBJECT,create_time, update_time,message,read_state) 
SELECT 'Alert','Synch Data',NOW(),NOW(),CONCAT(`name`,' is old'),0 FROM fs_files WHERE DATEDIFF(NOW(), file_dt)>=3;"

query[] = "SET @i=0;" 
query[] = "INSERT INTO lov (`name`, `type`, `description`, `value`,`status`, create_time, `order`) 
SELECT a.class,'class',a.class,a.class,1,NOW(),@i:=@i+1 FROM 
(SELECT DISTINCT
  `fs_styles`.`class` AS `class` 
FROM `fs_styles`
WHERE `fs_styles`.`class`<>''  and (instock is not null or onorder is not null)
ORDER BY `fs_styles`.`class`) AS a;"

query[] = "SET @i=0;"
query[] = "INSERT INTO lov (`name`, `type`, `description`, `value`,`status`, create_time, `order`)
SELECT a.lov,'dept',a.lov,a.lov,1,NOW(),@i:=@i+1 FROM 
(SELECT DISTINCT
  `fs_styles`.`dept` AS `lov` 
FROM `fs_styles`
WHERE `fs_styles`.`dept`<>''  and (instock is not null or onorder is not null)
ORDER BY `fs_styles`.`dept`) AS a;"

query[] = "SET @i=0;"
query[] = "INSERT INTO lov (`name`, `type`, `description`, `value`,`status`, create_time, `order`)
SELECT a.lov,'model',a.lov,a.lov,1,NOW(),@i:=@i+1 FROM 
(SELECT DISTINCT
  `fs_styles`.`model` AS `lov` 
FROM `fs_styles`
WHERE `fs_styles`.`model`<>'' and (instock is not null or onorder is not null)
ORDER BY `fs_styles`.`model`) AS a;"

query[] = "SET @i=0;" 
query[] = "INSERT INTO lov (`name`, `type`, `description`, `value`,`status`, create_time, `order`)
SELECT a.width,'width',a.width,a.width,1,NOW(),@i:=@i+1 FROM 
(SELECT DISTINCT
  `fs_styles`.`width` AS `width` 
FROM `fs_styles`
WHERE `fs_styles`.`width`<>'' and (instock is not null or onorder is not null)
ORDER BY `fs_styles`.`width`) AS a;"

query[] = "SET @i=0;" 
query[] = "INSERT INTO lov (`name`, `type`, `description`, `value`,`status`, create_time, `order`)
SELECT a.colour,'colour',a.colour,a.colour,1,NOW(),@i:=@i+1 FROM 
(SELECT DISTINCT
  `fs_styles`.`colour` AS `colour` 
FROM `fs_styles`
WHERE `fs_styles`.`colour`<>'' and (instock is not null or onorder is not null)
ORDER BY `fs_styles`.`colour`) AS a;"

query[] = "UPDATE fs_styles AS s,
(SELECT style_id, SUM(total) AS total
FROM fs_sales
WHERE period_dt >= NOW() - INTERVAL 1 YEAR
GROUP BY style_id) AS a
SET s.sales_yr = a.total
WHERE s.style_id=a.style_id;"

query[] = "UPDATE fs_styles AS s,
(SELECT style_id, SUM(total) AS total
FROM fs_sales
WHERE period_dt >= NOW() - INTERVAL 1 QUARTER
GROUP BY style_id) AS a
SET s.sales_qtr = a.total
WHERE s.style_id=a.style_id;"

query[] = "UPDATE fs_styles AS s,
(SELECT style_id, SUM(total) AS total
FROM fs_sales
WHERE period_dt >= NOW() - INTERVAL 1 MONTH
GROUP BY style_id) AS a
SET s.sales_mth = a.total
WHERE s.style_id=a.style_id;"